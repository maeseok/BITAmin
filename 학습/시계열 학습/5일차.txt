Chapter 6 시계열 분해

추세-주기, 계절성, 나머지

-6.1 시계열 성분
덧셈 분해 : 계절성 요동의 크기나 추세-주기 주위의 변동이 시계열의 수준에 의해 변하지 않을 때
곱셈 분해 : 계절성 패턴에서 변동이나 추세-주기 주위의 변동이 시계열의 수준에 비례할 때

곱셈 분해를 사용하는 대신, 시계열의 변동이 시간에 따라 안정적으로 나타날 때까지
덧셈 분해를 사용하는 것도 방법이다.

비계절성 데이터를 계절성으로 조정하여 분석한다.
계절성 조정된 데이터는 추세-주기 성분도 있고 나머지 성분도 있다.
시계열에서 전환점을 살펴보는 것과 어떤 방향으로의 변화를 해석하려는 것이 목적이면,
계절성으로 조정된 데이터보다는 추세-주기 성분을 사용하는 것이 낫다.

-6.2 이동평균
이동평균 : 추세-주기를 측정
평균이 데이터의 무작위성을 줄이고 매끄러운 추세-주기 성분만 남긴다.
차수 m의 이동평균이라는 의미는 "m-MA"라고 부른다.
ma(변수,차수)
차수는 추세-주기 추정치의 매끄러운 정도를 결정한다.

짝수이면 대칭적이지 않다.
이동평균을 이동평균하면 짝수 차수 이동 평균을 대칭적으로 만들 수 있다.

계절성 주기가 홀수이면서 차수m이면 m-MA -> 일주일 주기 데이터 7-MA
계절성 주기가 짝수이면서 차수m이면 2xm-MA -> 월별 데이터 -> 2X12-MA

가중 이동평균 : 이동평균의 조합 -> 더욱 매끄러운 추세-주기를 얻을 수 있다.
2x4-MA -> 5-MA와 같다.


-6.3 고전적인 분해법

덧셈 분해
1 단계
m이 짝수이면,  2×m-MA를 사용하여 추세-주기 성분  ^Tt을 계산합니다.  
m이 홀수이면,  m-MA를 사용하여 추세-주기 성분  ^Tt을 계산합니다.
2 단계
다음과 같이 추세를 제거한 시계열을 계산합니다:  yt−^Tt.
3 단계
각 계절마다 계절성분을 측정하기 위해, 해당 계절에 대해 추세를 제거한 값의 평균을 
구합시다. 예를 들면, 월별 데이터에서 3월의 계절성분은 데이터에서 추세를 제거한 
모든 3월 값의 평균입니다. 그러면 이러한 계절성분 값이 0 근처의 값이 되도록 
조정됩니다. 이러한 월별 값을 순서대로 모으고 각 연도의 데이터에 대한 수열을 
복제하여 계절성분을 구합니다. 이렇게 ^St을 얻습니다.
4 단계
다음과 같이 측정한 계절성과 추세-주기 성분을 빼서 나머지 성분을 계산합니다:  
^Rt=yt−^Tt−^St.

곱셈 분해 : 덧셈 분해법에서 뺼셈을 나눗셈으로 바꾸면 됨

-> 고전적인 덧셈, 곱셈 분해는 문제점이 있다.
1. 처음 몇 개와 마지막 몇 개의 관측값에 대한 추세 추정값을 얻을 수 없다.
2. 추세-주기 측정은 데이터에 나타나는 급격한 증가나 감소를 과도하게 매끄럽게 한다.
3. 계절성분이 매년 반복된다는 것을 가정한다.
4. 가끔 짧은 기간의 시계열 값이 특별히 이상할 수 있다.


-6.4 X11 분해
고전적인 분해 단점 극복위해 추가적인 단계와 특징을 포함
특별히 양 끝점을 포함한 모든 관측값에 대해 추세-주기 측정 가능,
계절성분이 시간에 따라 느리게 변하도록도 가능
seasonal패키지에 seas()함수로 구현 가능

-6.5 SEATS 분해
-> ARIMA 시계열에서 계절성 추출
seasonal패키지에서 seas()함수로 구현

-6.6 STL 분해
-> Loess를 사용한 계절성과 추세 분해
장점 : 
SEAT와 X11과는 다르게, STL은 월별이나 분기별 데이터를 포함하여 어떤 종류의 계절성도 다룰 수 있습니다.
계절적인 성분이 시간에 따라 변해도 괜찮습니다. 계절성분의 변화율을 사용자가 조절할 수 있습니다.
추세-주기의 매끄러운 정도를 사용자가 조절할 수 있습니다.
가끔 있는 이상값이 추세-주기와 계절성분에 영향을 주지 않게 만들 수 있습니다(즉, 사용자가 강력한 분해법을 명시할 수 있습니다). 하지만, 이상값은 나머지 성분(remainder)에 영향을 줄 것입니다.

단점 : 
특별히, 거래일이나 달력 변동을 자동으로 다루지 않고, 덧셈 분해만 지원한다.

둘 다 모두 홀수값만 가능
t.window : 추세-주기 윈도우로 추세-주기를 추정할 때 사용할 연이은 관측값의 개수
s.window : 계절성 윈도우로, 계절성분에서 각 값을 추정할 때 사용할 연이은 관측값 개수


-6.7 추세와 계절성의 강도 측정하기
시계열 분해는 시계열에서 추세와 계절성의 강도를 측정하는데 사용 가능
평활된 추세 성분 + 계절성 성분 + 나머지 성분

추세가 강하면 추세 강도를 0~1로 놓는다.
계절성이 강하면 계절성 강도를 0~1로 놓는다.
-> 데이터에서 시계열 개수가 많은 경우에 가장 추세, 계절성이 강한 것을 찾을 때 유용


-6.8 분해법으로 예측하기
분해된 시계열을 예측하기 위해, 계절성분과 계절성으로 조정된 성분을 각각 예측
-> 계절성분에 나이브 계절성 기법을 사용
-> 계절성으로 조정된 성분을 예측하기 위해서는 확률보행 모델, 홀트기법, 비-계절성 ARIMA 모델

-> 이를 통해 재계절화됨, 이는 불확실성이 매우 작다
stlf()를 통해 시계열을 분해하고 계절성으로 조정된 시계열 예측해 재계절화된 예측값 반환

















