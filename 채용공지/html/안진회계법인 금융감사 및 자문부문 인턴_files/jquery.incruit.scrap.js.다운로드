// Copyright ⓒ 1998~2017 Incruit Corporation All rights reserved

(function($){$.scrap=function(obj,param,options){var $this=$(obj);param.act="I";if($this.is(".on"))param.act="D";if(window._gaq)_gaq.push(['_trackEvent','scrap',document.location.pathname,document.location.search]);$.ajax({type:"POST",url:"/g_common/bizcommon/scrap_ajax.asp",data:param,success:function(msg){if(!msg)return;if(msg=="0"){alert('오류가 발생하였습니다. 잠시후 다시 시도해주세요.');}else if(msg.indexOf("error_no")>-1){var error_no=0;eval(msg);if(error_no==1000){if(options.layerlogin)options.layerlogin();else{var url=document.URL;if(url.indexOf("m.incruit.com")>-1)
location.href=G_HOSTNAME_EDIT+"/login/loginmobile.asp?gotoURL="+escape(url);else if(url.indexOf("m.alba.incruit.com")>-1)
location.href=G_HOSTNAME_EDIT+"/login/loginmobile.asp?gotoURL="+escape(url);else
var url=document.URL;if(url.indexOf("job.incruit.com/jobdb_info/popupjobpost.asp")>-1){iNcruitLayerLogin.show('scrap');}else{location.href=G_HOSTNAME_EDIT+"/login/login.asp?gotoURL="+escape(url);}}}else if(error_no==2000){alert("개인회원으로 로그인해주세요.");}}else if(msg.indexOf("alert")>-1){if(msg)alert(msg.substr(7,msg.length-10));}else{if($this.is(".on")){$this.removeClass("on");if(options.success)options.success("off",obj);if(options.count)options.count($this,"off");var val_right=$("#RightMenuScrap").text();$("#RightMenuScrap").text(parseInt(val_right)-1);$("em[id=Scrap_Cnt]").text(parseInt(val_right)-1);}else{$this.addClass("on");if(options.success)options.success("on",obj);if(options.count)options.count($this,"on");var val_right=$("#RightMenuScrap").text();$("#RightMenuScrap").text(parseInt(val_right)+1);$("em[id=Scrap_Cnt]").text(parseInt(val_right)+1);try{iNcruitApp.sendBridge('S','');}catch(e){}
fnShowAppLayer("appdwnlayer_scrpCnt");}}}});};$.fn.scrap=function(args){var list="";this.each(function(){var attr=$(this).attr("f_job");if(attr)list+=","+$(this).attr("f_job");});var buttons=this;if(window.document.cookie.indexOf("IsPersonal=Y")>0){if(list.length>0){list=list.substring(1);var param={act:'S',type:args.type,prefix:args.prefix,seq_list:list};$.ajax({type:"POST",url:"/g_common/bizcommon/scrap_ajax.asp",data:param,success:function(msg){if(!msg)return;try{if(msg.indexOf("doScripChecked")>=0){msg=msg.replaceAll("\r\n","");msg=msg.replaceAll("doScripChecked('icon_scrap__","");msg=msg.replaceAll("');",",");var arrRS=msg.split(",");for(var i=0;i<(arrRS.length-1);i++){buttons.filter("[f_job='"+arrRS[i]+"']").addClass("on");}}
if(args.type=="EDU"){var arrRS=msg.split(",");for(var i=0;i<arrRS.length;i++){buttons.filter("[f_job='"+arrRS[i]+"']").addClass("on");}}}catch(ex){}}});}}
return this.each(function(){var $this=$(this);if($this.is(".on"))
$this.attr("f_act","D");else
$this.attr("f_act","I");if(args.type)$this.attr("f_type",args.type);if(args.company)$this.attr("f_company",args.company);if(args.mem)$this.attr("f_mem",args.mem);if(args.job)$this.attr("f_job",args.job);if(args.success)eSuccess=args.success;if(args.count!='undefined')eCount=args.count;if(args.layerlogin!='undefined')eLayerLogin=args.layerlogin;$this.click(function(event){event.stopPropagation();var param=new Object();var options=new Object();param.act=$this.attr("f_act");if($this.attr("f_act"))param.type=$this.attr("f_type");if($this.attr("f_company"))param.company=$this.attr("f_company");if($this.attr("f_mem"))param.mem=$this.attr("f_mem");if($this.attr("f_job"))param.job=$this.attr("f_job");if($this.attr("f_lec"))param.lecNo=$this.attr("f_lec");if(eSuccess)options.success=eSuccess;if(eCount)options.count=eCount;if(eLayerLogin)options.layerlogin=eLayerLogin;$.scrap(this,param,options);});});};})(jQuery);function fnCloseAppLayer(){jQuery(".appDownLayerPopWrap").hide();var today=new Date();today.setDate(today.getDate()+parseInt(1));document.cookie='appdownlayer_scrp='+escape('true')+'; path=/; expires='+today.toGMTString()+';';}
function fnShowAppLayer(cName){var cnt=1;var CookieCNT=getCookie(cName);var strDomain='.incruit.com';var randomNum=Math.floor(Math.random()*2)+1;if(CookieCNT==""){CookieCNT=0;}
cnt=parseInt(CookieCNT)+parseInt(cnt);var today=new Date();today.setDate(today.getDate()+parseInt(1));if(cName=="appdwnlayer_scrpCnt"&&cnt<"4"){if(getCookie("appdwn_scrapG")!=""){return;}
jQuery("#appDownInlay_Sub_G1").show();jQuery("#appDownInlay_Sub_scrap").show();}else if(cName=="appdwnlayer_scrpCompCnt"&&cnt<"4"){if(getCookie("appdwn_scrapC")!=""){return;}
if(randomNum==1){}else{jQuery("#appDownInlay_Sub_C1").html("<span><strong>관심기업 채용정보 업데이트?</strong></span>");jQuery("#appDownInlay_Sub_C2").html("<strong>앱으로 알림 받는게 가장 빨라요!</strong>");}
jQuery("#appDownInlay_Sub_interest").show();}
if(cnt>=4){var cDay=7;today.setDate(today.getDate()+cDay);if(cName=="appdwnlayer_scrpCnt"){document.cookie='appdwn_scrapG='+escape("7day")+'; path=/; expires='+today.toGMTString()+';domain='+strDomain+';';}else{document.cookie='appdwn_scrapC='+escape("7day")+'; path=/; expires='+today.toGMTString()+';domain='+strDomain+';';}}else{document.cookie=cName+'='+escape(cnt)+'; path=/; expires='+today.toGMTString()+';domain='+strDomain+';';}}
function getCookie(cName){cName=cName+'=';var cookieData=document.cookie;var start=cookieData.indexOf(cName);var cValue='';if(start!=-1){start+=cName.length;var end=cookieData.indexOf(';',start);if(end==-1)end=cookieData.length;cValue=cookieData.substring(start,end);}
return unescape(cValue);}