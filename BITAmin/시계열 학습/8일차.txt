Chapter 10 pass

Chapter 11 고급 예측 기법

-11.1 복잡한 계절성
일별 패턴, 주별 패턴, 연간 패턴
-> 다중 계절성 시계열은 위 3개 중에 여러 개를 포함하는 것을 뜻함
   이는 msts 클래스로 다룬다.
-> mstl() 함수는 여러 계절성을 고려하도록 stl()을 변형한 것이다.

동적 조화 회귀
-> 푸리에 항을 통해서 다중 계절성을 다룰 수 있다.

TBATS 모델
계절성이 TBATS 모델에서 시간에 따라 느리게 변할 수 있다
긴 시계열을 추정하는데 느릴 수 있다.

공변량
-> 동적 조화 회귀 모델에는 들어갈 수 있어도 TBATS는 허용하지 않는다.


-11.2 벡터 자기회귀
지금까지 모델은 단 방향 관계에 있었다.
즉 독립변수는 종속변수의 영향을 받지만 반대는 아니라는 뜻
이를 VAR(벡터 자기회귀)에서 허용한다.

정상성 만족하면 데이터 맞춰서 예측
만족하지 않으면 차분을 구하고, VAR 모델을 맞춘다.

얼마나 많은 변수와 많은 시차값이 시스템에 있어야 하는지 판단해야한다.
k(변수), p(시차값)
-> R의 vars의 VARselect() -> AIC, HQ, BIC, FPE
-> AIC 이용 시 시차 값의 수가 크게 선택되는 경향 있음, BIC가 VAR 최적

1.분명한 해석이 필요 없을 때 관련된 변수의 모임을 예측할 때;
2.(그랑거(Granger) 인과율(causality) 검정에 기초하여) 한 변수가 다른 것을 예측 할 때 유용한지 판단할 때;
3.충격 반응 분석(impulse response analysis), 한 변수가 다른 한 변수의 갑작스럽지만 일시적인 변화에 반응하는 것을 분석할 때;
4.예측 분산 분해를 예측할 때, 다른 변수의 효과의 결과가 각 변수의 예측 분산의 비율이 될 때.


-11.3 신경망 모델
입력층 - 은닉층 -출력층

선형 회귀
신경망 자기 회귀(NNAR 모델) -> ARIMA(p,0,0) = NNAR(p,0) 하지만 정상성 관련한 제한조건x
-> nnetar(), 선형 AR(p) 모델에 대해 AIC 따라 고르는 최적 시차
-> 선형적인 AR 모델은 반복되는 패턴 모델링 시 항상 대칭적이다.
   하지만 신경망은 비대칭성도 잡아냄

예측구간
-> 신경망은 잘 정의된 확률 모델에 기초하지 않는다.
   그렇기에 예측값에 대한 예측구간 유도하는 것이 어렵다.
   붓스트랩된 잔차를 이용해 만든 미래 표본 경로로 묘사하면 얻을 수 있다.


-11.4 붓스트랩과 배깅
시계열을 박스-칵스 변환
이후 STL로 추세, 계절성, 나머지 성분으로 분리
STL 나머지 성분 시계열에서 자기상관값이 나타날 수 있다.
대신에 블록된 붓스트랩 사용
시계열의 인접 부분은 무작위로 골라서 서로 붙인 것,
이러한 붓스트랩된 나머지 시계열을 추세와 시계열 성분에 더해,
원본 시계열의 변형된 형태를 얻기 위해 역 박스-칵스 변환 
-> 이는 예측 불확실성을 더 잘 나타내는 측정값을 얻을 수 있다.
   또한 배깅을 이용해 점 예측값을 향상시키는 방법으로 이어진다.

예측구간
-> 예측 작업에서 시계열 모델 이용할 때 불확실성 원인 4가지
1.무작위 오차 항;
2.매개변수 추정;
3.과거 데이터에 대해 모델을 선택한 것;
4.과거 데이터의 연장선 상에서 미래 것을 생성하는 과정.
일반적으로 1~3만 고려
-> 이러한 문제 해결은 붓스트랩으로 해결 가능
bld.mbb.bootstrap()

배깅한 ETS 예측
배깅 : 원본 시계열에서 단순하게 직접 예측한 것보다 더 나은 예측값 얻는다.
-> baggedETS()












