Chapter 7 지수평활

지수평활을 사용하여 얻은 예측값은 과거 관측값의 가중평균이다.
과거 관측값은 오래될 수록 지수적으로 감소하는 가중치를 갖는다.


-7.1 단순 지수평활
추세나 계절성 패턴이 없는 데이터를 예측할 때 쓰기 좋다.
단순 기법에서는 가장 최근 관측값만 가장 중요한 유일한 값,
평균 기법에서는 모든 관측값이 똑같이 중요하고, 예측값을 생성할 때 이러한 관측값에 같은 가중치
-> 이는 최근 관측값에 더 큰 가중치를 주는 일이 필요할 때 단순 지수평활을 사용

1. 가중 평균 형태
2. 성분 형태 : 유일한 성분은 수준값이다. 
-> 단순 지수 평활의 성분 형태는 특별히 유용하지 않지만, 다른 성분 추가할 때 사용편리
3. 평평한 예측값 : 모든 예측값이 마지막 수준 성분과 같은 값을 갖는다.
-> 시계열에 추세나 계절 성분이 없을 때 사용할 수 있다.
4. 최적화 : 평활 매개변수와 초기값 필요 -> 모든 예측치를 계산할 수 있다.
-> 2개 이상의 매개변수와 초기 성분, SSE 사용해 매개변수와 초기값 구함
-> 회귀 모델과 다르게, 이 경우는 비선형 최소화 문제이다.


-7.2 추세 기법
1. 홀트의 선형 추세 기법
-> 추세가 있는 데이터를 예측할 수 있도록 단순 지수 평활을 확장했다.
-> 예측식과 두 개의 평활식을 포함
-> 가중 평균, 한 단계 앞 학습 예측
-> 예측 함수는 평평하지 않고 추세를 가진다.

2. 감쇠 추세 기법
-> 홀트 추세 기법 미래에도 계속 일정한 추세기에 과도한 예측
-> 미래 어느 시점에 추세를 평평하게 감쇠시키는 한 가지 매개변수 도입

-> 둘다 holt() 함수를 이용해 R에서 구현

비-계절성 기법의 예측력
1. ses
2. holt
3. 감쇠 추세 기법
-> 감쇠 홀트 기법이 가장 좋다.


-7.3 홀트-윈터스의 계절성 기법
-> 예측식과 3개의 평활식(수준, 추세, 계절 성분)
-> 계절 성분의 성질에 따라 두 가지 변형
1. 덧셈 기법 : 계절성 변동이 시계열 전반에 걸쳐 거의 일정할 때
2. 곱셈 기법 : 계절성 변동이 시계열의 수준에 비례하게 변할 때

hw() 사용해서 구현
EX) 국제선 여행객이 호주에서 보내는 분기별 숙박일수 예측(계절성 패턴)
-> 두 모델의 RMSE를 비교한 결과 곱셈 계절성이 더 잘 맞는다.
-> 시계열의 수준이 증가하면서 데이터에 나타나는 계절성 변동 증가하기 때문

홀트-윈터스의 감시 기법
-> 위 두 기법 모두 감쇠 효과를 추가할 수 있다.


-7.4 지수 평활 기법 분류 체계
추세와 계절적인 성분의 조합을 고려하면 15개의 지수 평활 기법이 가능
-> 덧셈 추세 + 곱셈 계절성 등 

-7.5 지수 평활에 대한 혁신 상태 공간 모델
지수 평활 기법은 점 예측값을 내는 알고리즘이다.

1. ETS : 덧셈 오차를 이용하는 단순 지수평활(A,N,N)
-> 무작위 오차 과정을 사용한다는 것이 혁신
-> 다른 혁신 상태 공간 모델의 경우에는 비선형적일 수 있다.

2. ETS : 곱셈 오차를 이용하는 단순 지수평활(M,N,N)
-> 한 단계 앞 학습 오차를 상대적인 오차로 써서 곱셈 오차를 이용하는 모델

3. ETS : 덧셈 오차를 이용한 홀트의 선형 기법(A,A,N)
-> 홀트의 선형 기법에 대한 오차 보정식에 대입

4. ETS : 곱셈 오차를 이용하는 홀트의 선형 기법(M,A,N)
-> 한 단계 앞 학습 오차를 상대적인 오차로 적고 곱셈 오차 이용하는 홀트의 선형 기법

다른 ETS 모델도 많음


-7.6 추정과 모델 선택
제곱 오차의 합을 최소화하여 매개변수를 추정하는 방법의 하나는 가능도를 최대화하는 것
가능도는 특정한 모델에서 일어나는 데이터의 확률이다.


1. 모델 선택 : 정보 기준을 사용(AIC, AICc, BIC)
-> 이들은 모델의 가능도와 잔차 분석을 포함하여 추정되는 매개변수와 초기 상태의 전체 개수를 포함
-> 곱셈 오차는 데이터가 양수일 때만 유용, 아니면 덧셈 오차는


R의 forecast의 ets() : 모델 추정, 예측값 x, 매개 변수 추정, 모델 정보 돌려줌
-> 이는 기본적으로 AICc를 기본값으로 모델 고름
-> 덧셈, 곱셈, 없음, 자동 등 가능하고 이외에도 감쇠 추세, 평활 매개변수,
   박스-칵스 변환 매개변수, 역 변환된 적합값과 예측값 편향 조정 등 옵션 선택 가능


-7.7 ETS 모델로 예측하기
ETS 점 예측값은 예측 분포의 중간값과 같다.
덧셈 성분만 이용하는 모델의 경우, 예측 분포가 정규 분포라서 평균과 중앙값 같다.
곱셉 오차 혹은 계절성 이용하는 경우, 점 예측값은 예측분포의 평균값과 같지 않다.

-> 예측구간도 생성할 수 있다. (포함확률, 예측 분산 등 )






















